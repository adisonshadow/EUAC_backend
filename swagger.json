{
  "openapi": "3.0.0",
  "info": {
    "title": "UAC API Documentation",
    "version": "1.0.0",
    "description": "用户认证和授权系统 API 文档"
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "开发服务器"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "DepartmentTreeItem": {
        "type": "object",
        "properties": {
          "department_id": {
            "type": "string",
            "format": "uuid",
            "example": "550e8400-e29b-41d4-a716-446655440000",
            "description": "部门ID"
          },
          "name": {
            "type": "string",
            "example": "前端组",
            "description": "部门名称"
          },
          "description": {
            "type": "string",
            "nullable": true,
            "example": "负责前端开发",
            "description": "部门描述"
          },
          "parent_id": {
            "type": "string",
            "format": "uuid",
            "nullable": true,
            "example": "550e8400-e29b-41d4-a716-446655440000",
            "description": "父部门ID"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "DISABLED"
            ],
            "example": "ACTIVE",
            "description": "部门状态"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "example": "2024-03-21T10:00:00.000Z",
            "description": "创建时间"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "example": "2024-03-21T10:00:00.000Z",
            "description": "更新时间"
          },
          "children": {
            "type": "array",
            "description": "子部门列表",
            "items": {
              "$ref": "#/components/schemas/DepartmentTreeItem"
            }
          }
        }
      },
      "Error": {
        "type": "object",
        "properties": {
          "code": {
            "type": "integer",
            "example": 400
          },
          "message": {
            "type": "string",
            "example": "参数错误"
          },
          "data": {
            "type": "object",
            "example": null,
            "nullable": true
          }
        }
      },
      "SSOConfig": {
        "type": "object",
        "required": [
          "protocol",
          "redirect_uri",
          "salt"
        ],
        "properties": {
          "protocol": {
            "type": "string",
            "enum": [
              "SAML",
              "CAS",
              "OIDC",
              "OAuth"
            ],
            "description": "SSO使用的协议",
            "example": "OIDC"
          },
          "redirect_uri": {
            "type": "string",
            "format": "uri",
            "description": "SSO回调地址",
            "example": "https://hrms.example.com/auth/callback"
          },
          "salt": {
            "type": "string",
            "description": "SSO签名盐值，用于JWT签名",
            "example": "sso-salt-123"
          },
          "secret": {
            "type": "string",
            "description": "基于currenttime、salt，使用 bcrypt 生成的Hash值",
            "example": "$2a$10$xxxxx"
          },
          "currentTimestample": {
            "type": "integer",
            "description": "当前时间戳， 用于生成secret",
            "example": 17198592000
          },
          "additional_params": {
            "type": "object",
            "description": "其他SSO协议特定的参数",
            "additionalProperties": true,
            "example": {
              "client_id": "hrms-client",
              "client_secret": "your-client-secret",
              "issuer": "https://sso.example.com"
            }
          }
        }
      },
      "APIConnectConfig": {
        "type": "object",
        "required": [
          "salt"
        ],
        "properties": {
          "app_secret": {
            "type": "string",
            "description": "应用API私钥（由服务端根据 application_id 和 salt 生成）",
            "example": "wLTAwMDAtMDAwMDAwMDAwMDAxIiwidXNlcm5hbWUiOiJhZG1pbiIsImlhdCI6MTc0OTE4MTAyMCwiZXhwIjoxNzQ5MjY3NDIwfQ.VOfXDBi5DeWGTsAMzRmBNfP4AikJhT6WevpupizBrm4"
          },
          "salt": {
            "type": "string",
            "description": "签名盐值",
            "example": "random-salt-456"
          }
        }
      },
      "APIDataScope": {
        "type": "object",
        "description": "API数据权限范围配置",
        "additionalProperties": {
          "type": "string",
          "enum": [
            "all",
            "department",
            "self"
          ],
          "description": "数据权限范围"
        },
        "example": {
          "user:read": "department",
          "user:write": "self",
          "department:read": "all"
        }
      },
      "Application": {
        "type": "object",
        "properties": {
          "application_id": {
            "type": "string",
            "format": "uuid",
            "description": "应用ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "name": {
            "type": "string",
            "description": "应用名称",
            "example": "人力资源管理系统"
          },
          "code": {
            "type": "string",
            "description": "应用编码",
            "example": "hrms"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "DISABLED"
            ],
            "description": "应用状态",
            "example": "ACTIVE"
          },
          "sso_enabled": {
            "type": "boolean",
            "description": "是否启用SSO",
            "example": true
          },
          "sso_config": {
            "$ref": "#/components/schemas/SSOConfig"
          },
          "api_enabled": {
            "type": "boolean",
            "description": "是否启用API服务",
            "example": true
          },
          "api_connect_config": {
            "$ref": "#/components/schemas/APIConnectConfig"
          },
          "api_data_scope": {
            "$ref": "#/components/schemas/APIDataScope"
          },
          "description": {
            "type": "string",
            "description": "应用描述",
            "example": "公司人力资源管理系统"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "deleted_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "删除时间",
            "example": null
          }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "user_id": {
            "type": "string",
            "format": "uuid",
            "description": "用户ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "username": {
            "type": "string",
            "description": "用户名",
            "example": "admin"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "邮箱",
            "example": "admin@example.com"
          },
          "phone": {
            "type": "string",
            "description": "电话",
            "example": "13800138000"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "DISABLED",
              "ARCHIVED"
            ],
            "description": "用户状态",
            "example": "ACTIVE"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "password": {
            "type": "string",
            "description": "密码（仅在创建时使用）",
            "example": "password123"
          },
          "name": {
            "type": "string",
            "description": "姓名",
            "example": "管理员"
          },
          "gender": {
            "type": "string",
            "enum": [
              "MALE",
              "FEMALE",
              "OTHER"
            ],
            "description": "性别",
            "example": "MALE"
          },
          "avatar": {
            "type": "string",
            "description": "头像URL",
            "example": "https://example.com/avatar.jpg"
          },
          "department_id": {
            "type": "string",
            "format": "uuid",
            "description": "部门ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "last_login_at": {
            "type": "string",
            "format": "date-time",
            "description": "最后登录时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "deleted_at": {
            "type": "string",
            "format": "date-time",
            "description": "删除时间（软删除）",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "roles": {
            "type": "array",
            "description": "用户角色列表",
            "items": {
              "$ref": "#/components/schemas/Role"
            }
          }
        }
      },
      "Role": {
        "type": "object",
        "properties": {
          "role_id": {
            "type": "string",
            "format": "uuid",
            "description": "角色ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "role_name": {
            "type": "string",
            "description": "角色名称",
            "example": "管理员"
          },
          "code": {
            "type": "string",
            "description": "角色编码",
            "example": "ADMIN"
          },
          "description": {
            "type": "string",
            "description": "角色描述",
            "example": "系统管理员角色"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "DISABLED",
              "ARCHIVED"
            ],
            "description": "角色状态",
            "example": "ACTIVE"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "deleted_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true,
            "description": "删除时间",
            "example": null
          },
          "permissions": {
            "type": "array",
            "description": "角色权限列表",
            "items": {
              "$ref": "#/components/schemas/Permission"
            }
          }
        }
      },
      "Permission": {
        "type": "object",
        "properties": {
          "permission_id": {
            "type": "string",
            "format": "uuid",
            "description": "权限ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "name": {
            "type": "string",
            "description": "权限名称",
            "example": "用户管理"
          },
          "code": {
            "type": "string",
            "description": "权限编码",
            "example": "user:manage"
          },
          "description": {
            "type": "string",
            "description": "权限描述",
            "example": "允许对用户进行增删改查操作"
          },
          "resource_type": {
            "type": "string",
            "description": "资源类型",
            "enum": [
              "MENU",
              "BUTTON",
              "API"
            ],
            "example": "MENU"
          },
          "actions": {
            "type": "array",
            "description": "操作类型列表",
            "items": {
              "type": "string",
              "enum": [
                "create",
                "read",
                "update",
                "delete"
              ]
            },
            "example": [
              "create",
              "read",
              "update",
              "delete"
            ]
          },
          "parent_id": {
            "type": "string",
            "format": "uuid",
            "description": "父权限ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "DISABLED",
              "ARCHIVED"
            ],
            "description": "权限状态",
            "example": "ACTIVE"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "deleted_at": {
            "type": "string",
            "format": "date-time",
            "description": "删除时间（软删除）",
            "example": "2024-03-21T10:00:00.000Z"
          }
        }
      },
      "Department": {
        "type": "object",
        "properties": {
          "department_id": {
            "type": "string",
            "format": "uuid",
            "description": "部门ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "name": {
            "type": "string",
            "description": "部门名称",
            "example": "技术部"
          },
          "code": {
            "type": "string",
            "description": "部门编码",
            "example": "TECH"
          },
          "parent_id": {
            "type": "string",
            "format": "uuid",
            "description": "父部门ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "status": {
            "type": "string",
            "enum": [
              "ACTIVE",
              "DISABLED"
            ],
            "description": "部门状态",
            "example": "ACTIVE"
          },
          "description": {
            "type": "string",
            "description": "部门描述",
            "example": "负责公司技术研发"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "manager_id": {
            "type": "string",
            "format": "uuid",
            "description": "部门主管ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "deleted_at": {
            "type": "string",
            "format": "date-time",
            "description": "删除时间（软删除）",
            "example": "2024-03-21T10:00:00.000Z"
          },
          "manager": {
            "$ref": "#/components/schemas/User"
          },
          "parent": {
            "$ref": "#/components/schemas/Department"
          },
          "children": {
            "type": "array",
            "description": "子部门列表",
            "items": {
              "$ref": "#/components/schemas/Department"
            }
          }
        }
      },
      "File": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "filename": {
            "type": "string"
          },
          "originalname": {
            "type": "string"
          },
          "mimetype": {
            "type": "string"
          },
          "size": {
            "type": "integer"
          },
          "path": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "Captcha": {
        "type": "object",
        "properties": {
          "captcha_id": {
            "type": "string",
            "format": "uuid"
          },
          "target_position": {
            "type": "object",
            "properties": {
              "x": {
                "type": "number"
              },
              "y": {
                "type": "number"
              }
            }
          },
          "image": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "RolePermission": {
        "type": "object",
        "properties": {
          "permission_id": {
            "type": "string",
            "format": "uuid",
            "description": "权限ID",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "name": {
            "type": "string",
            "description": "权限名称",
            "example": "用户管理"
          },
          "code": {
            "type": "string",
            "description": "权限编码",
            "example": "user:manage"
          },
          "resource_type": {
            "type": "string",
            "enum": [
              "MENU",
              "BUTTON",
              "API"
            ],
            "description": "资源类型",
            "example": "API"
          },
          "actions": {
            "type": "array",
            "description": "操作类型列表",
            "items": {
              "type": "string",
              "enum": [
                "create",
                "read",
                "update",
                "delete"
              ]
            },
            "example": [
              "create",
              "read",
              "update",
              "delete"
            ]
          }
        }
      },
      "RoleListResponse": {
        "type": "object",
        "properties": {
          "code": {
            "type": "integer",
            "example": 200
          },
          "message": {
            "type": "string",
            "example": "获取角色列表成功"
          },
          "data": {
            "type": "object",
            "properties": {
              "total": {
                "type": "integer",
                "description": "总记录数",
                "example": 10
              },
              "items": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Role"
                }
              },
              "page": {
                "type": "integer",
                "description": "当前页码",
                "example": 1
              },
              "size": {
                "type": "integer",
                "description": "每页数量",
                "example": 10
              }
            }
          }
        }
      },
      "RoleResponse": {
        "type": "object",
        "properties": {
          "code": {
            "type": "integer",
            "example": 200
          },
          "message": {
            "type": "string",
            "example": "操作成功"
          },
          "data": {
            "$ref": "#/components/schemas/Role"
          }
        }
      }
    }
  },
  "paths": {
    "/api/v1/applications": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "创建应用",
        "description": "创建一个新的应用",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "code"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "应用名称",
                    "example": "人力资源管理系统"
                  },
                  "code": {
                    "type": "string",
                    "description": "应用编码",
                    "example": "hrms"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "ACTIVE",
                      "DISABLED"
                    ],
                    "description": "应用状态",
                    "example": "ACTIVE"
                  },
                  "sso_enabled": {
                    "type": "boolean",
                    "description": "是否启用SSO",
                    "example": true
                  },
                  "sso_config": {
                    "$ref": "#/components/schemas/SSOConfig"
                  },
                  "api_enabled": {
                    "type": "boolean",
                    "description": "是否启用API服务",
                    "example": true
                  },
                  "api_connect_config": {
                    "$ref": "#/components/schemas/APIConnectConfig"
                  },
                  "api_data_scope": {
                    "$ref": "#/components/schemas/APIDataScope"
                  },
                  "description": {
                    "type": "string",
                    "description": "应用描述",
                    "example": "公司人力资源管理系统"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "创建成功"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Application"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Applications"
        ],
        "summary": "获取应用列表",
        "description": "获取应用列表，支持分页和筛选。当 size 参数为 -1 时，返回所有记录不分页。",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            },
            "description": "页码（当 size 不为 -1 时有效）"
          },
          {
            "name": "size",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": -1,
              "maximum": 100
            },
            "description": "每页数量，设置为 -1 时返回所有记录不分页"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "应用名称（支持模糊匹配）"
          },
          {
            "name": "code",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "应用编码（支持模糊匹配）"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "ACTIVE",
                "DISABLED"
              ]
            },
            "description": "应用状态"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "integer",
                          "description": "总记录数（当 size 为 -1 时等于 items 的长度）",
                          "example": 100
                        },
                        "page": {
                          "type": "integer",
                          "description": "当前页码（当 size 为 -1 时固定为 1）",
                          "example": 1
                        },
                        "size": {
                          "type": "integer",
                          "description": "每页数量（当 size 为 -1 时等于总记录数）",
                          "example": 10
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Application"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/applications/{id}": {
      "get": {
        "tags": [
          "Applications"
        ],
        "summary": "获取应用详情",
        "description": "根据ID获取应用详情",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "应用ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "获取成功"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Application"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "应用不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Applications"
        ],
        "summary": "更新应用",
        "description": "更新应用信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "应用ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "应用名称",
                    "example": "人力资源管理系统"
                  },
                  "code": {
                    "type": "string",
                    "description": "应用编码",
                    "example": "hrms"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "ACTIVE",
                      "DISABLED"
                    ],
                    "description": "应用状态",
                    "example": "ACTIVE"
                  },
                  "sso_enabled": {
                    "type": "boolean",
                    "description": "是否启用SSO",
                    "example": true
                  },
                  "sso_config": {
                    "$ref": "#/components/schemas/SSOConfig"
                  },
                  "api_enabled": {
                    "type": "boolean",
                    "description": "是否启用API服务",
                    "example": true
                  },
                  "api_connect_config": {
                    "$ref": "#/components/schemas/APIConnectConfig"
                  },
                  "api_data_scope": {
                    "$ref": "#/components/schemas/APIDataScope"
                  },
                  "description": {
                    "type": "string",
                    "description": "应用描述",
                    "example": "公司人力资源管理系统"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "更新成功"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Application"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "应用不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Applications"
        ],
        "summary": "删除应用",
        "description": "删除指定应用",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "应用ID"
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "删除成功"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "应用不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/applications/{id}/generate-secret": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "生成应用密钥",
        "description": "根据应用ID和salt生成app_secret，并保存到应用的api_connect_config中",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "应用ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "salt"
                ],
                "properties": {
                  "salt": {
                    "type": "string",
                    "description": "签名盐值",
                    "example": "random-salt-123"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "生成成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "生成成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "app_secret": {
                          "type": "string",
                          "description": "应用密钥",
                          "example": "a1b2c3d4e5f6g7h8i9j0..."
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "应用不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/applications/token": {
      "post": {
        "tags": [
          "Applications"
        ],
        "summary": "获取应用Token",
        "description": "根据应用ID和app_secret获取JWT Token，用于应用API认证",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "application_id",
                  "app_secret"
                ],
                "properties": {
                  "application_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "应用ID",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                  },
                  "app_secret": {
                    "type": "string",
                    "description": "应用密钥",
                    "example": "a1b2c3d4e5f6g7h8i9j0..."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "获取成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": {
                          "type": "string",
                          "description": "JWT Token",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "认证失败",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "应用不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/applications-sso/{id}": {
      "get": {
        "tags": [
          "Applications SSO"
        ],
        "summary": "获取SSO应用信息",
        "description": "获取指定应用的SSO配置信息，用于SSO登录流程",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "应用ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "application_id": {
                          "type": "string",
                          "format": "uuid",
                          "description": "应用ID",
                          "example": "7913b18c-e3f2-4d40-8b6b-b0239c98fef6"
                        },
                        "name": {
                          "type": "string",
                          "description": "应用名称",
                          "example": "业务数据设计系统"
                        },
                        "code": {
                          "type": "string",
                          "description": "应用编码",
                          "example": "bdc"
                        },
                        "status": {
                          "type": "string",
                          "enum": [
                            "ACTIVE",
                            "DISABLED"
                          ],
                          "description": "应用状态",
                          "example": "ACTIVE"
                        },
                        "sso_enabled": {
                          "type": "boolean",
                          "description": "是否启用SSO",
                          "example": true
                        },
                        "sso_config": {
                          "type": "object",
                          "properties": {
                            "currentTimestample": {
                              "type": "string",
                              "description": "当前时间戳",
                              "example": "1703123456789"
                            },
                            "secret": {
                              "type": "string",
                              "description": "使用bcrypt加密的时间戳",
                              "example": "$2a$10$xxxxxx"
                            },
                            "protocol": {
                              "type": "string",
                              "enum": [
                                "SAML",
                                "CAS",
                                "OIDC",
                                "OAuth"
                              ],
                              "description": "SSO协议",
                              "example": "OAuth"
                            },
                            "redirect_uri": {
                              "type": "string",
                              "format": "uri",
                              "description": "SSO回调地址",
                              "example": "http://localhost:3300/sso-callback"
                            }
                          }
                        },
                        "description": {
                          "type": "string",
                          "nullable": true,
                          "description": "应用描述",
                          "example": null
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "description": "创建时间",
                          "example": "2025-06-15T14:24:25.599Z"
                        },
                        "updated_at": {
                          "type": "string",
                          "format": "date-time",
                          "description": "更新时间",
                          "example": "2025-06-25T16:13:32.447Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误或SSO未启用",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "该应用未启用SSO"
                    },
                    "data": {
                      "type": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "应用不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "应用端不存在"
                    },
                    "data": {
                      "type": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "获取SSO应用信息失败"
                    },
                    "error": {
                      "type": "string",
                      "example": "Internal server error"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "用户登录",
        "description": "用户登录接口，支持验证码验证和SSO配置返回",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "password"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "用户名",
                    "example": "admin"
                  },
                  "password": {
                    "type": "string",
                    "description": "密码",
                    "example": 123456
                  },
                  "application_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "应用ID，如果提供则返回该应用的SSO配置",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                  },
                  "captcha_data": {
                    "type": "object",
                    "description": "验证码数据",
                    "properties": {
                      "captcha_id": {
                        "type": "string",
                        "description": "验证码ID",
                        "example": "550e8400-e29b-41d4-a716-446655440000"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "登录成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": {
                          "type": "string",
                          "description": "访问令牌",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        },
                        "refresh_token": {
                          "type": "string",
                          "description": "刷新令牌",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        },
                        "expires_in": {
                          "type": "string",
                          "description": "令牌过期时间",
                          "example": "2h"
                        },
                        "user_id": {
                          "type": "string",
                          "description": "用户ID",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "sso": {
                          "type": "object",
                          "description": "SSO配置信息（仅当提供application_id且应用启用了SSO时返回）",
                          "properties": {
                            "application_id": {
                              "type": "string",
                              "format": "uuid",
                              "description": "应用ID",
                              "example": "550e8400-e29b-41d4-a716-446655440000"
                            },
                            "application_name": {
                              "type": "string",
                              "description": "应用名称",
                              "example": "人力资源管理系统"
                            },
                            "application_code": {
                              "type": "string",
                              "description": "应用编码",
                              "example": "hrms"
                            },
                            "sso_config": {
                              "$ref": "#/components/schemas/SSOConfig"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "202": {
            "description": "需要验证码",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 202
                    },
                    "message": {
                      "type": "string",
                      "example": "需要验证码"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "need_captcha": {
                          "type": "boolean",
                          "example": true
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误或验证码无效",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "验证码无效或未验证"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "用户名或密码错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "用户名或密码错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "用户已被禁用",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 403
                    },
                    "message": {
                      "type": "string",
                      "example": "用户已被禁用"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "429": {
            "description": "登录失败次数过多",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 429
                    },
                    "message": {
                      "type": "string",
                      "example": "登录失败次数过多，请一小时后重试"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "next_attempt_time": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T11:00:00.000Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/refresh": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "刷新访问令牌",
        "description": "使用刷新令牌获取新的访问令牌，支持第三方系统通过app参数刷新token",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "refresh_token"
                ],
                "properties": {
                  "refresh_token": {
                    "type": "string",
                    "description": "刷新令牌",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  },
                  "app": {
                    "type": "string",
                    "format": "uuid",
                    "description": "应用ID，用于第三方系统刷新token（可选）",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "刷新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": {
                          "type": "string",
                          "description": "新的访问令牌",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        },
                        "refresh_token": {
                          "type": "string",
                          "description": "新的刷新令牌",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        },
                        "expires_in": {
                          "type": "string",
                          "description": "令牌过期时间",
                          "example": "2h"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误或无效的应用ID",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "刷新令牌不能为空"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "刷新令牌无效",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "刷新令牌无效或已过期"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "用户登出",
        "description": "用户登出接口，使当前访问令牌失效",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "refresh_token": {
                    "type": "string",
                    "description": "刷新令牌",
                    "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "登出成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "登出成功"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未登录",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/captcha": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "获取验证码",
        "description": "获取登录验证码图片",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "验证码生成成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "captcha_id": {
                          "type": "string",
                          "description": "验证码ID",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "bg_url": {
                          "type": "string",
                          "description": "背景图片URL",
                          "example": "https://example.com/bg.jpg"
                        },
                        "puzzle_url": {
                          "type": "string",
                          "description": "拼图图片URL",
                          "example": "https://example.com/puzzle.jpg"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/check": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "检查用户登录状态",
        "description": "检查当前用户的登录状态，支持两种使用方式：\n\n1. **标准模式**：不传任何参数，使用默认JWT密钥验证token\n2. **SSO模式**：通过query参数app传递应用ID，使用对应应用的salt验证token\n\n**使用场景**：\n- 前端应用验证用户登录状态\n- 第三方系统验证SSO token有效性\n- 获取当前登录用户的详细信息\n\n**认证方式**：Bearer Token\n\n**响应说明**：\n- 200: 用户已登录，返回用户信息\n- 400: 无效的应用ID或SSO配置（仅SSO模式）\n- 401: 未登录或token无效\n- 500: 服务器内部错误\n",
        "parameters": [
          {
            "in": "query",
            "name": "app",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": false,
            "description": "应用ID，用于SSO模式下的token验证\n\n**使用场景**：\n- 第三方系统需要验证特定应用的token\n- 使用应用特定的salt进行JWT验证\n\n**注意事项**：\n- 应用必须已启用SSO功能\n- 应用必须配置有效的salt\n- 不传此参数时使用默认JWT密钥验证\n",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "用户已登录",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "user_id": {
                          "type": "string",
                          "description": "用户ID",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "username": {
                          "type": "string",
                          "description": "用户名",
                          "example": "admin"
                        },
                        "name": {
                          "type": "string",
                          "description": "姓名",
                          "example": "管理员"
                        },
                        "avatar": {
                          "type": "string",
                          "description": "头像URL",
                          "example": "https://example.com/avatar.jpg"
                        },
                        "gender": {
                          "type": "string",
                          "description": "性别",
                          "example": "MALE"
                        },
                        "email": {
                          "type": "string",
                          "description": "邮箱",
                          "example": "admin@example.com"
                        },
                        "phone": {
                          "type": "string",
                          "description": "手机号",
                          "example": "13800138000"
                        },
                        "status": {
                          "type": "string",
                          "description": "状态",
                          "example": "ACTIVE"
                        },
                        "department_id": {
                          "type": "string",
                          "description": "部门ID",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "无效的应用ID或SSO配置",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "无效的应用ID或SSO配置"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未登录或令牌无效",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未提供认证令牌"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/captcha": {
      "get": {
        "tags": [
          "Captcha"
        ],
        "summary": "获取验证码",
        "description": "获取登录验证码图片",
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "captcha_id": {
                          "type": "string",
                          "description": "验证码ID",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "bg_url": {
                          "type": "string",
                          "description": "背景图片URL",
                          "example": "https://example.com/bg.jpg"
                        },
                        "puzzle_url": {
                          "type": "string",
                          "description": "拼图图片URL",
                          "example": "https://example.com/puzzle.jpg"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/captcha/verify": {
      "post": {
        "tags": [
          "Captcha"
        ],
        "summary": "验证滑块位置",
        "description": "验证用户滑动轨迹",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "captcha_id",
                  "duration",
                  "trail"
                ],
                "properties": {
                  "captcha_id": {
                    "type": "string",
                    "description": "验证码ID"
                  },
                  "duration": {
                    "type": "number",
                    "description": "滑动持续时间（毫秒）"
                  },
                  "trail": {
                    "type": "array",
                    "description": "滑动轨迹",
                    "items": {
                      "type": "object",
                      "properties": {
                        "x": {
                          "type": "number",
                          "description": "X坐标"
                        },
                        "y": {
                          "type": "number",
                          "description": "Y坐标"
                        },
                        "timestamp": {
                          "type": "number",
                          "description": "时间戳"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "验证成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "verified": {
                          "type": "boolean",
                          "example": true
                        },
                        "reason": {
                          "type": "string",
                          "example": "验证通过"
                        },
                        "details": {
                          "type": "object",
                          "properties": {
                            "trajectory": {
                              "type": "object",
                              "properties": {
                                "score": {
                                  "type": "number"
                                },
                                "reason": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            },
                            "velocity": {
                              "type": "object",
                              "properties": {
                                "score": {
                                  "type": "number"
                                },
                                "reason": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            },
                            "repetition": {
                              "type": "object",
                              "properties": {
                                "score": {
                                  "type": "number"
                                },
                                "reason": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            },
                            "totalScore": {
                              "type": "number"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "验证失败",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "验证失败"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "verified": {
                          "type": "boolean",
                          "example": false
                        },
                        "reason": {
                          "type": "string",
                          "example": "轨迹点数不足"
                        },
                        "details": {
                          "type": "object",
                          "properties": {
                            "trajectory": {
                              "type": "object",
                              "properties": {
                                "score": {
                                  "type": "number"
                                },
                                "reason": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            },
                            "velocity": {
                              "type": "object",
                              "properties": {
                                "score": {
                                  "type": "number"
                                },
                                "reason": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            },
                            "repetition": {
                              "type": "object",
                              "properties": {
                                "score": {
                                  "type": "number"
                                },
                                "reason": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            },
                            "totalScore": {
                              "type": "number"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "验证失败"
                    },
                    "data": {
                      "type": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/departments": {
      "post": {
        "tags": [
          "Departments"
        ],
        "summary": "创建部门",
        "description": "创建新的部门",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "部门名称",
                    "example": "技术部"
                  },
                  "description": {
                    "type": "string",
                    "description": "部门描述",
                    "example": "负责公司技术研发"
                  },
                  "parent_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "父部门ID",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                  },
                  "status": {
                    "type": "string",
                    "description": "部门状态",
                    "enum": [
                      "ACTIVE",
                      "DISABLED"
                    ],
                    "default": "ACTIVE",
                    "example": "ACTIVE"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 201
                    },
                    "message": {
                      "type": "string",
                      "example": "部门创建成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "department_id": {
                          "type": "string",
                          "format": "uuid",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "name": {
                          "type": "string",
                          "example": "技术部"
                        },
                        "description": {
                          "type": "string",
                          "example": "负责公司技术研发"
                        },
                        "parent_id": {
                          "type": "string",
                          "format": "uuid",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "status": {
                          "type": "string",
                          "example": "ACTIVE"
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Departments"
        ],
        "summary": "获取部门列表",
        "description": "获取部门列表，支持分页和筛选。当 size 参数为 -1 时，返回所有记录不分页。",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            },
            "description": "页码（当 size 不为 -1 时有效）"
          },
          {
            "name": "size",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": -1,
              "maximum": 100
            },
            "description": "每页数量，设置为 -1 时返回所有记录不分页"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "部门名称（支持模糊匹配）"
          },
          {
            "name": "code",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "部门编码（支持模糊匹配）"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "ACTIVE",
                "DISABLED"
              ]
            },
            "description": "部门状态"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "integer",
                          "description": "总记录数（当 size 为 -1 时等于 items 的长度）",
                          "example": 100
                        },
                        "page": {
                          "type": "integer",
                          "description": "当前页码（当 size 为 -1 时固定为 1）",
                          "example": 1
                        },
                        "size": {
                          "type": "integer",
                          "description": "每页数量（当 size 为 -1 时等于总记录数）",
                          "example": 10
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Department"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/departments/tree": {
      "get": {
        "tags": [
          "Departments"
        ],
        "summary": "获取部门树",
        "description": "获取部门树形结构，返回所有未删除的部门，按层级组织",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/DepartmentTreeItem"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/departments/{department_id}": {
      "get": {
        "tags": [
          "Departments"
        ],
        "summary": "获取部门详情",
        "description": "获取指定部门的详细信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "department_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "部门ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "department_id": {
                          "type": "string",
                          "format": "uuid",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "name": {
                          "type": "string",
                          "example": "技术部"
                        },
                        "description": {
                          "type": "string",
                          "example": "负责公司技术研发"
                        },
                        "parent_id": {
                          "type": "string",
                          "format": "uuid",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "status": {
                          "type": "string",
                          "example": "ACTIVE"
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        },
                        "updated_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        },
                        "parent": {
                          "type": "object",
                          "properties": {
                            "department_id": {
                              "type": "string",
                              "format": "uuid",
                              "example": "550e8400-e29b-41d4-a716-446655440000"
                            },
                            "name": {
                              "type": "string",
                              "example": "研发中心"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "部门不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Departments"
        ],
        "summary": "更新部门",
        "description": "更新指定部门的信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "department_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "部门ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "部门名称",
                    "example": "技术部"
                  },
                  "description": {
                    "type": "string",
                    "description": "部门描述",
                    "example": "负责公司技术研发"
                  },
                  "parent_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "父部门ID",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                  },
                  "status": {
                    "type": "string",
                    "description": "部门状态",
                    "enum": [
                      "ACTIVE",
                      "DISABLED"
                    ],
                    "example": "ACTIVE"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "department_id": {
                          "type": "string",
                          "format": "uuid",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "name": {
                          "type": "string",
                          "example": "技术部"
                        },
                        "description": {
                          "type": "string",
                          "example": "负责公司技术研发"
                        },
                        "parent_id": {
                          "type": "string",
                          "format": "uuid",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "status": {
                          "type": "string",
                          "example": "ACTIVE"
                        },
                        "updated_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "部门不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Departments"
        ],
        "summary": "删除部门",
        "description": "删除指定部门",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "department_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "部门ID"
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "存在子部门，无法删除",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "部门不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/departments/{department_id}/users": {
      "get": {
        "tags": [
          "Departments"
        ],
        "summary": "获取部门用户",
        "description": "获取指定部门的所有用户",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "department_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "部门ID"
          },
          {
            "in": "query",
            "name": "include_children",
            "schema": {
              "type": "boolean",
              "default": false
            },
            "description": "是否包含子部门的用户"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "user_id": {
                            "type": "string",
                            "format": "uuid",
                            "example": "550e8400-e29b-41d4-a716-446655440000"
                          },
                          "username": {
                            "type": "string",
                            "example": "zhangsan"
                          },
                          "name": {
                            "type": "string",
                            "example": "张三"
                          },
                          "email": {
                            "type": "string",
                            "example": "zhangsan@example.com"
                          },
                          "phone": {
                            "type": "string",
                            "example": "13800138000"
                          },
                          "status": {
                            "type": "string",
                            "example": "ACTIVE"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "404": {
            "description": "部门不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/dev/login": {
      "post": {
        "tags": [
          "Dev"
        ],
        "summary": "开发环境专用登录接口",
        "description": "仅限开发环境使用的登录接口，无需验证码",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "password"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "用户名",
                    "example": "admin"
                  },
                  "password": {
                    "type": "string",
                    "description": "密码",
                    "example": "123456"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "登录成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "number",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "登录成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": {
                          "type": "string",
                          "description": "JWT token",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        },
                        "refresh_token": {
                          "type": "string",
                          "description": "刷新令牌",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        },
                        "expires_in": {
                          "type": "string",
                          "description": "令牌过期时间",
                          "example": "2h"
                        },
                        "user_id": {
                          "type": "string",
                          "description": "用户ID",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "user": {
                          "type": "object",
                          "properties": {
                            "user_id": {
                              "type": "string"
                            },
                            "username": {
                              "type": "string"
                            },
                            "email": {
                              "type": "string"
                            },
                            "roles": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "role_id": {
                                    "type": "string"
                                  },
                                  "role_name": {
                                    "type": "string"
                                  },
                                  "code": {
                                    "type": "string"
                                  },
                                  "permissions": {
                                    "type": "array",
                                    "items": {
                                      "type": "object",
                                      "properties": {
                                        "permission_id": {
                                          "type": "string"
                                        },
                                        "permission_name": {
                                          "type": "string"
                                        },
                                        "code": {
                                          "type": "string"
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "用户名或密码错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "用户名或密码错误"
          },
          "403": {
            "description": "非开发环境",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 403
                    },
                    "message": {
                      "type": "string",
                      "example": "用户已被禁用"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "健康检查",
        "description": "检查系统运行状态，包括服务器状态和数据库连接状态",
        "responses": {
          "200": {
            "description": "服务正常",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "status": {
                          "type": "string",
                          "description": "系统整体状态，ok 表示完全正常，warning 表示部分异常",
                          "enum": [
                            "ok",
                            "warning"
                          ],
                          "example": "ok"
                        },
                        "timestamp": {
                          "type": "string",
                          "format": "date-time",
                          "description": "检查时间",
                          "example": "2024-03-21T10:00:00.000Z"
                        },
                        "version": {
                          "type": "string",
                          "description": "系统版本号",
                          "example": "1.0.0"
                        },
                        "uptime": {
                          "type": "number",
                          "description": "系统运行时间（秒）",
                          "example": 3600
                        },
                        "memory": {
                          "type": "object",
                          "description": "内存使用情况",
                          "properties": {
                            "total": {
                              "type": "number",
                              "description": "总内存（字节）",
                              "example": 8589934592
                            },
                            "free": {
                              "type": "number",
                              "description": "可用内存（字节）",
                              "example": 4294967296
                            },
                            "used": {
                              "type": "number",
                              "description": "已用内存（字节）",
                              "example": 2147483648
                            }
                          }
                        },
                        "cpu": {
                          "type": "object",
                          "description": "CPU 使用情况",
                          "properties": {
                            "cores": {
                              "type": "number",
                              "description": "CPU 核心数",
                              "example": 4
                            },
                            "loadAvg": {
                              "type": "array",
                              "description": "CPU 负载平均值（1分钟、5分钟、15分钟）",
                              "items": {
                                "type": "number"
                              },
                              "example": [
                                1.5,
                                1.2,
                                1
                              ]
                            }
                          }
                        },
                        "database": {
                          "type": "object",
                          "description": "数据库连接状态",
                          "properties": {
                            "status": {
                              "type": "string",
                              "description": "数据库连接状态",
                              "enum": [
                                "ok",
                                "error"
                              ],
                              "example": "ok"
                            },
                            "message": {
                              "type": "string",
                              "description": "数据库状态描述",
                              "example": "数据库连接正常"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "健康检查失败"
                    },
                    "error": {
                      "type": "string",
                      "description": "错误详情"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/permissions": {
      "post": {
        "tags": [
          "Permissions"
        ],
        "summary": "创建权限",
        "description": "创建新的权限",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "code",
                  "resource_type",
                  "actions"
                ],
                "properties": {
                  "code": {
                    "type": "string",
                    "description": "权限编码",
                    "example": "user:manage"
                  },
                  "description": {
                    "type": "string",
                    "description": "权限描述",
                    "example": "允许对用户进行增删改查操作"
                  },
                  "resource_type": {
                    "type": "string",
                    "description": "资源类型",
                    "enum": [
                      "MENU",
                      "BUTTON",
                      "API"
                    ],
                    "example": "MENU"
                  },
                  "actions": {
                    "type": "array",
                    "description": "操作类型列表",
                    "items": {
                      "type": "string",
                      "enum": [
                        "create",
                        "read",
                        "update",
                        "delete"
                      ]
                    },
                    "example": [
                      "create",
                      "read",
                      "update",
                      "delete"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 201
                    },
                    "message": {
                      "type": "string",
                      "example": "权限创建成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "permission_id": {
                          "type": "string",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "code": {
                          "type": "string",
                          "example": "user:manage"
                        },
                        "description": {
                          "type": "string",
                          "example": "允许对用户进行增删改查操作"
                        },
                        "resource_type": {
                          "type": "string",
                          "example": "MENU"
                        },
                        "actions": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "example": [
                            "create",
                            "read",
                            "update",
                            "delete"
                          ]
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "权限编码、资源类型和操作类型不能为空"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Permissions"
        ],
        "summary": "获取权限列表",
        "description": "获取权限列表，支持分页和筛选。当 size 参数为 -1 时，返回所有记录不分页。",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            },
            "description": "页码（当 size 不为 -1 时有效）"
          },
          {
            "name": "size",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": -1,
              "maximum": 100
            },
            "description": "每页数量，设置为 -1 时返回所有记录不分页"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "权限名称（支持模糊匹配）"
          },
          {
            "name": "code",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "权限编码（支持模糊匹配）"
          },
          {
            "name": "type",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "MENU",
                "BUTTON",
                "API"
              ]
            },
            "description": "权限类型"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "ACTIVE",
                "DISABLED"
              ]
            },
            "description": "权限状态"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "integer",
                          "description": "总记录数（当 size 为 -1 时等于 items 的长度）",
                          "example": 100
                        },
                        "page": {
                          "type": "integer",
                          "description": "当前页码（当 size 为 -1 时固定为 1）",
                          "example": 1
                        },
                        "size": {
                          "type": "integer",
                          "description": "每页数量（当 size 为 -1 时等于总记录数）",
                          "example": 10
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Permission"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/permissions/{permission_id}": {
      "get": {
        "tags": [
          "Permissions"
        ],
        "summary": "获取权限详情",
        "description": "获取指定权限的详细信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "permission_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "权限ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "permission_id": {
                          "type": "string",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "code": {
                          "type": "string",
                          "example": "user:manage"
                        },
                        "description": {
                          "type": "string",
                          "example": "允许对用户进行增删改查操作"
                        },
                        "resource_type": {
                          "type": "string",
                          "example": "MENU"
                        },
                        "actions": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "example": [
                            "create",
                            "read",
                            "update",
                            "delete"
                          ]
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        },
                        "updated_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "权限不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "权限不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Permissions"
        ],
        "summary": "更新权限",
        "description": "更新指定权限的信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "permission_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "权限ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "description": {
                    "type": "string",
                    "description": "权限描述",
                    "example": "允许对用户进行增删改查操作"
                  },
                  "resource_type": {
                    "type": "string",
                    "description": "资源类型",
                    "enum": [
                      "MENU",
                      "BUTTON",
                      "API"
                    ],
                    "example": "MENU"
                  },
                  "actions": {
                    "type": "array",
                    "description": "操作类型列表",
                    "items": {
                      "type": "string",
                      "enum": [
                        "create",
                        "read",
                        "update",
                        "delete"
                      ]
                    },
                    "example": [
                      "create",
                      "read",
                      "update",
                      "delete"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "权限更新成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "permission_id": {
                          "type": "string"
                        },
                        "code": {
                          "type": "string"
                        },
                        "description": {
                          "type": "string"
                        },
                        "resource_type": {
                          "type": "string"
                        },
                        "actions": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "权限不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      },
      "delete": {
        "tags": [
          "Permissions"
        ],
        "summary": "删除权限",
        "description": "删除指定权限",
        "parameters": [
          {
            "name": "permission_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "权限ID"
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "权限删除成功"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "权限不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/permissions/{permission_id}/roles": {
      "post": {
        "tags": [
          "Permissions"
        ],
        "summary": "分配角色权限",
        "description": "为指定角色分配权限",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "permission_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "权限ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "role_ids"
                ],
                "properties": {
                  "role_ids": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "description": "角色ID列表"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "分配成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "权限分配成功"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          },
          "404": {
            "description": "权限不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/permissions/users/{user_id}": {
      "get": {
        "tags": [
          "Permissions"
        ],
        "summary": "获取用户权限",
        "description": "获取指定用户的所有权限",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "用户ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "获取用户权限成功"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "permission_id": {
                            "type": "string"
                          },
                          "permission_name": {
                            "type": "string"
                          },
                          "code": {
                            "type": "string"
                          },
                          "description": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "用户不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/permissions/check": {
      "get": {
        "tags": [
          "Permissions"
        ],
        "summary": "检查权限",
        "description": "检查用户是否拥有指定资源类型的多个操作权限",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "user_id",
            "in": "query",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "用户ID"
          },
          {
            "name": "resource_type",
            "in": "query",
            "required": true,
            "type": "string",
            "enum": [
              "MENU",
              "BUTTON",
              "API"
            ],
            "description": "资源类型"
          },
          {
            "name": "action",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "操作类型，多个操作类型用逗号分隔，例如：create,read,update",
            "example": "create,read,update"
          }
        ],
        "responses": {
          "200": {
            "description": "检查成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "权限检查成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "has_permission": {
                          "type": "boolean",
                          "description": "是否拥有所有请求的操作权限",
                          "example": true
                        },
                        "permissions": {
                          "type": "array",
                          "description": "用户拥有的相关权限列表",
                          "items": {
                            "type": "object",
                            "properties": {
                              "permission_id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "name": {
                                "type": "string"
                              },
                              "code": {
                                "type": "string"
                              },
                              "actions": {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "缺少必要参数或无效的操作类型"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "用户不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/permissions/rules": {
      "post": {
        "tags": [
          "Permissions"
        ],
        "summary": "创建数据权限规则",
        "description": "创建新的数据权限规则",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "role_id",
                  "resource_type",
                  "conditions"
                ],
                "properties": {
                  "role_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "角色ID"
                  },
                  "resource_type": {
                    "type": "string",
                    "description": "资源类型"
                  },
                  "conditions": {
                    "type": "object",
                    "description": "权限条件"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "数据权限规则创建成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "rule_id": {
                          "type": "string"
                        },
                        "role_id": {
                          "type": "string"
                        },
                        "resource_type": {
                          "type": "string"
                        },
                        "conditions": {
                          "type": "object"
                        },
                        "status": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          },
          "404": {
            "description": "角色不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      },
      "get": {
        "tags": [
          "Permissions"
        ],
        "summary": "获取数据权限规则列表",
        "description": "获取所有数据权限规则",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "获取数据权限规则列表成功"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "rule_id": {
                            "type": "string"
                          },
                          "role_id": {
                            "type": "string"
                          },
                          "resource_type": {
                            "type": "string"
                          },
                          "conditions": {
                            "type": "object"
                          },
                          "status": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/roles": {
      "post": {
        "tags": [
          "Roles"
        ],
        "summary": "创建角色",
        "description": "创建新角色",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "role_name",
                  "code"
                ],
                "properties": {
                  "role_name": {
                    "type": "string",
                    "description": "角色名称",
                    "example": "管理员"
                  },
                  "code": {
                    "type": "string",
                    "description": "角色编码",
                    "example": "ADMIN"
                  },
                  "description": {
                    "type": "string",
                    "description": "角色描述",
                    "example": "系统管理员角色"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "ACTIVE",
                      "DISABLED",
                      "ARCHIVED"
                    ],
                    "default": "ACTIVE",
                    "description": "角色状态",
                    "example": "ACTIVE"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleResponse"
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "角色名称和编码不能为空"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Roles"
        ],
        "summary": "获取角色列表",
        "description": "获取角色列表，支持分页和筛选。当 size 参数为 -1 时，返回所有记录不分页。",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            },
            "description": "页码（当 size 不为 -1 时有效）"
          },
          {
            "name": "size",
            "in": "query",
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": -1,
              "maximum": 100
            },
            "description": "每页数量，设置为 -1 时返回所有记录不分页"
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "角色名称（支持模糊匹配）"
          },
          {
            "name": "code",
            "in": "query",
            "schema": {
              "type": "string"
            },
            "description": "角色编码（支持模糊匹配）"
          },
          {
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "ACTIVE",
                "DISABLED"
              ]
            },
            "description": "角色状态"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "integer",
                          "description": "总记录数（当 size 为 -1 时等于 items 的长度）",
                          "example": 100
                        },
                        "page": {
                          "type": "integer",
                          "description": "当前页码（当 size 为 -1 时固定为 1）",
                          "example": 1
                        },
                        "size": {
                          "type": "integer",
                          "description": "每页数量（当 size 为 -1 时等于总记录数）",
                          "example": 10
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Role"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/roles/{role_id}": {
      "get": {
        "tags": [
          "Roles"
        ],
        "summary": "获取角色详情",
        "description": "获取指定角色的详细信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "角色ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleResponse"
                }
              }
            }
          },
          "404": {
            "description": "角色不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      },
      "put": {
        "tags": [
          "Roles"
        ],
        "summary": "更新角色信息",
        "description": "更新指定角色的信息",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "角色ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "role_name": {
                    "type": "string",
                    "description": "角色名称"
                  },
                  "description": {
                    "type": "string",
                    "description": "角色描述"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RoleResponse"
                }
              }
            }
          },
          "404": {
            "description": "角色不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      },
      "delete": {
        "tags": [
          "Roles"
        ],
        "summary": "删除角色",
        "description": "软删除指定角色",
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "角色ID"
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "角色删除成功"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "角色不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/roles/{role_id}/permissions": {
      "post": {
        "tags": [
          "Roles"
        ],
        "summary": "给角色分配权限",
        "description": "完全替换角色的现有权限，设置新的权限列表",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "角色ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "permission_ids"
                ],
                "properties": {
                  "permission_ids": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "description": "权限ID列表"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "权限分配成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "权限分配成功"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          },
          "404": {
            "description": "角色不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      },
      "put": {
        "tags": [
          "Roles"
        ],
        "summary": "更新角色权限",
        "description": "更新角色的权限列表，可以添加或删除权限",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "role_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "uuid",
            "description": "角色ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "add_permissions",
                  "remove_permissions"
                ],
                "properties": {
                  "add_permissions": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "description": "要添加的权限ID列表"
                  },
                  "remove_permissions": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "description": "要移除的权限ID列表"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "权限更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "权限更新成功"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          },
          "404": {
            "description": "角色不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/roles/check-permission": {
      "get": {
        "tags": [
          "Roles"
        ],
        "summary": "检查用户权限",
        "description": "检查当前用户是否拥有指定权限",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "permission_code",
            "in": "query",
            "required": true,
            "type": "string",
            "description": "权限编码"
          }
        ],
        "responses": {
          "200": {
            "description": "检查成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "has_permission": {
                          "type": "boolean"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未登录"
          },
          "403": {
            "description": "无权限"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/uploads": {
      "post": {
        "tags": [
          "Uploads"
        ],
        "summary": "上传文件",
        "description": "上传单个文件，支持图片自动转换为webp格式",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "type",
            "schema": {
              "type": "string",
              "enum": [
                "image",
                "document",
                "video",
                "audio"
              ]
            },
            "description": "文件类型，默认为配置中的默认类型"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "file"
                ],
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "要上传的文件"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "上传成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "type": {
                          "type": "string",
                          "example": "image"
                        },
                        "url": {
                          "type": "string",
                          "example": "http://localhost:3000/api/v1/uploads/images/550e8400-e29b-41d4-a716-446655440000"
                        },
                        "original_name": {
                          "type": "string",
                          "example": "example.jpg"
                        },
                        "size": {
                          "type": "integer",
                          "example": 1024
                        },
                        "mime_type": {
                          "type": "string",
                          "example": "image/jpeg"
                        },
                        "extension": {
                          "type": "string",
                          "example": ".webp"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "不支持的文件类型"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/uploads/multiple": {
      "post": {
        "tags": [
          "Uploads"
        ],
        "summary": "上传多个文件",
        "description": "同时上传多个文件",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "files": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "binary"
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "上传成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "文件上传成功"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "filename": {
                            "type": "string"
                          },
                          "originalname": {
                            "type": "string"
                          },
                          "mimetype": {
                            "type": "string"
                          },
                          "size": {
                            "type": "integer"
                          },
                          "path": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/uploads/image": {
      "post": {
        "tags": [
          "Uploads"
        ],
        "summary": "上传图片",
        "description": "上传单个图片，支持压缩和格式转换",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "image"
                ],
                "properties": {
                  "image": {
                    "type": "string",
                    "format": "binary",
                    "description": "要上传的图片文件"
                  },
                  "compress": {
                    "type": "boolean",
                    "description": "是否压缩图片",
                    "default": true
                  },
                  "format": {
                    "type": "string",
                    "enum": [
                      "jpeg",
                      "jpg",
                      "png",
                      "webp",
                      "gif"
                    ],
                    "description": "输出格式",
                    "default": "webp"
                  },
                  "width": {
                    "type": "integer",
                    "description": "压缩后的最大宽度",
                    "default": 1920
                  },
                  "height": {
                    "type": "integer",
                    "description": "压缩后的最大高度",
                    "default": 1920
                  },
                  "quality": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 100,
                    "description": "图片质量（1-100）",
                    "default": 80
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "上传成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "图片上传成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "filename": {
                          "type": "string",
                          "example": "550e8400-e29b-41d4-a716-446655440000.webp"
                        },
                        "originalname": {
                          "type": "string",
                          "example": "example.jpg"
                        },
                        "mimetype": {
                          "type": "string",
                          "example": "image/webp"
                        },
                        "size": {
                          "type": "integer",
                          "example": 102400
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/uploads/images/{file_id}": {
      "get": {
        "tags": [
          "Uploads"
        ],
        "summary": "获取图片",
        "description": "获取指定图片，支持实时裁剪、格式转换和缓存",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "file_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "文件ID"
          },
          {
            "in": "query",
            "name": "width",
            "schema": {
              "type": "integer"
            },
            "description": "图片宽度"
          },
          {
            "in": "query",
            "name": "height",
            "schema": {
              "type": "integer"
            },
            "description": "图片高度"
          },
          {
            "in": "query",
            "name": "quality",
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100
            },
            "description": "图片质量（1-100）"
          },
          {
            "in": "query",
            "name": "format",
            "schema": {
              "type": "string",
              "enum": [
                "jpeg",
                "jpg",
                "png",
                "webp",
                "gif"
              ]
            },
            "description": "输出格式"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "image/*": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "文件不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/uploads/{file_id}": {
      "get": {
        "tags": [
          "Uploads"
        ],
        "summary": "获取文件信息",
        "description": "获取指定文件的详细信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "file_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "文件ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "file_id": {
                          "type": "string",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "filename": {
                          "type": "string",
                          "example": "example.jpg"
                        },
                        "originalname": {
                          "type": "string",
                          "example": "original.jpg"
                        },
                        "mimetype": {
                          "type": "string",
                          "example": "image/jpeg"
                        },
                        "size": {
                          "type": "integer",
                          "example": 1024
                        },
                        "url": {
                          "type": "string",
                          "example": "https://example.com/uploads/example.jpg"
                        },
                        "created_at": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2024-03-21T10:00:00.000Z"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "文件不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "文件不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Uploads"
        ],
        "summary": "删除文件",
        "description": "删除指定文件",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "file_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "文件ID"
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "文件删除成功"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "文件不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "文件不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "创建用户",
        "description": "创建新用户",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "password",
                  "name"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "用户名",
                    "example": "newuser"
                  },
                  "password": {
                    "type": "string",
                    "description": "密码",
                    "minLength": 6,
                    "example": "123456"
                  },
                  "name": {
                    "type": "string",
                    "description": "姓名",
                    "example": "新用户"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "邮箱",
                    "example": "newuser@example.com"
                  },
                  "phone": {
                    "type": "string",
                    "pattern": "^1[3-9]\\d{9}$",
                    "description": "电话",
                    "example": "13800138000"
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "MALE",
                      "FEMALE",
                      "OTHER"
                    ],
                    "description": "性别",
                    "example": "MALE"
                  },
                  "avatar": {
                    "type": "string",
                    "description": "头像URL",
                    "example": "https://example.com/avatar.jpg"
                  },
                  "department_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "部门ID",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                  },
                  "role_ids": {
                    "type": "array",
                    "description": "角色ID列表",
                    "items": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "example": [
                      "550e8400-e29b-41d4-a716-446655440000"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "创建成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 201
                    },
                    "message": {
                      "type": "string",
                      "example": "用户创建成功"
                    },
                    "data": {
                      "$ref": "#/components/schemas/User"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "用户名已存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "获取用户列表",
        "description": "获取用户列表，支持分页和多种筛选条件",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            },
            "description": "页码"
          },
          {
            "in": "query",
            "name": "size",
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": 1,
              "maximum": 100
            },
            "description": "每页数量"
          },
          {
            "in": "query",
            "name": "username",
            "schema": {
              "type": "string"
            },
            "description": "用户名（支持模糊匹配）"
          },
          {
            "in": "query",
            "name": "name",
            "schema": {
              "type": "string"
            },
            "description": "姓名（支持模糊匹配）"
          },
          {
            "in": "query",
            "name": "email",
            "schema": {
              "type": "string",
              "format": "email"
            },
            "description": "邮箱（支持模糊匹配）"
          },
          {
            "in": "query",
            "name": "phone",
            "schema": {
              "type": "string",
              "pattern": "^1[3-9]\\d{9}$"
            },
            "description": "电话（支持模糊匹配）"
          },
          {
            "in": "query",
            "name": "status",
            "schema": {
              "type": "string",
              "enum": [
                "ACTIVE",
                "DISABLED",
                "ARCHIVED"
              ]
            },
            "description": "用户状态"
          },
          {
            "in": "query",
            "name": "gender",
            "schema": {
              "type": "string",
              "enum": [
                "MALE",
                "FEMALE",
                "OTHER"
              ]
            },
            "description": "性别"
          },
          {
            "in": "query",
            "name": "department_id",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "部门ID"
          },
          {
            "in": "query",
            "name": "user_id",
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "用户ID（精确匹配）"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "total": {
                          "type": "integer",
                          "example": 100
                        },
                        "page": {
                          "type": "integer",
                          "example": 1
                        },
                        "size": {
                          "type": "integer",
                          "example": 10
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/User"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{user_id}": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "获取用户详情",
        "description": "获取指定用户的详细信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "user_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "用户ID"
          }
        ],
        "responses": {
          "200": {
            "description": "获取成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "$ref": "#/components/schemas/User"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "用户不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "用户不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "Users"
        ],
        "summary": "更新用户信息",
        "description": "更新指定用户的信息",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "user_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "用户ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "姓名",
                    "example": "新名字"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "邮箱",
                    "example": "newemail@example.com"
                  },
                  "phone": {
                    "type": "string",
                    "pattern": "^1[3-9]\\d{9}$",
                    "description": "电话",
                    "example": "13800138001"
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "MALE",
                      "FEMALE",
                      "OTHER"
                    ],
                    "description": "性别",
                    "example": "MALE"
                  },
                  "avatar": {
                    "type": "string",
                    "description": "头像URL",
                    "example": "https://example.com/avatar.jpg"
                  },
                  "department_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "部门ID",
                    "example": "550e8400-e29b-41d4-a716-446655440000"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "ACTIVE",
                      "DISABLED",
                      "ARCHIVED"
                    ],
                    "description": "用户状态",
                    "example": "ACTIVE"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "用户信息更新成功"
                    },
                    "data": {
                      "$ref": "#/components/schemas/User"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "用户不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "用户不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Users"
        ],
        "summary": "删除用户",
        "description": "删除指定用户",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "user_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "用户ID"
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "用户删除成功"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "用户不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "用户不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{user_id}/roles": {
      "put": {
        "tags": [
          "Users"
        ],
        "summary": "更新用户角色",
        "description": "更新指定用户的角色",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "user_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "用户ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "role_ids"
                ],
                "properties": {
                  "role_ids": {
                    "type": "array",
                    "description": "角色ID列表",
                    "items": {
                      "type": "string"
                    },
                    "example": [
                      "550e8400-e29b-41d4-a716-446655440000"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "用户角色更新成功"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "user_id": {
                          "type": "string",
                          "example": "550e8400-e29b-41d4-a716-446655440000"
                        },
                        "roles": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "role_id": {
                                "type": "string",
                                "example": "550e8400-e29b-41d4-a716-446655440000"
                              },
                              "name": {
                                "type": "string",
                                "example": "管理员"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "用户不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "用户不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{user_id}/status": {
      "put": {
        "tags": [
          "Users"
        ],
        "summary": "更新用户状态",
        "description": "更新指定用户的状态",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "用户ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "status"
                ],
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "ACTIVE",
                      "DISABLED",
                      "ARCHIVED"
                    ],
                    "description": "用户状态"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "更新成功"
          },
          "404": {
            "description": "用户不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/users/{user_id}/avatar": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "上传用户头像",
        "description": "上传并更新用户头像",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "用户ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "required": [
                  "avatar"
                ],
                "properties": {
                  "avatar": {
                    "type": "string",
                    "format": "binary",
                    "description": "头像文件"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "上传成功"
          },
          "400": {
            "description": "参数错误"
          },
          "404": {
            "description": "用户不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/users/{user_id}/restore": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "恢复已删除用户",
        "description": "恢复被软删除的用户",
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "用户ID"
          }
        ],
        "responses": {
          "200": {
            "description": "恢复成功"
          },
          "404": {
            "description": "用户不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/users/{user_id}/change-password": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "修改密码",
        "description": "用户通过旧密码修改为新密码",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "user_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "用户ID"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "old_password",
                  "new_password"
                ],
                "properties": {
                  "old_password": {
                    "type": "string",
                    "description": "旧密码",
                    "example": "oldpass123"
                  },
                  "new_password": {
                    "type": "string",
                    "description": "新密码",
                    "minLength": 6,
                    "example": "newpass123"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "密码修改成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "密码修改成功"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误或原密码错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "原密码错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 401
                    },
                    "message": {
                      "type": "string",
                      "example": "未授权"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "用户不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 404
                    },
                    "message": {
                      "type": "string",
                      "example": "用户不存在"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/reset-password": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "重置密码",
        "description": "重置用户密码",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "email"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "用户名"
                  },
                  "email": {
                    "type": "string",
                    "description": "邮箱"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "重置成功"
          },
          "400": {
            "description": "参数错误"
          },
          "404": {
            "description": "用户不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        }
      }
    },
    "/api/v1/users/request-password-reset": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "请求重置密码",
        "description": "通过用户名和邮箱请求重置密码，系统会发送重置令牌到邮箱",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "email"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "用户名",
                    "example": "admin"
                  },
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "邮箱",
                    "example": "admin@example.com"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "请求成功，重置令牌已发送到邮箱",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "重置密码邮件已发送"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误或用户不存在",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "用户名或邮箱不正确"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/reset-password-with-token": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "使用令牌重置密码",
        "description": "使用重置令牌重置密码",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "username",
                  "token",
                  "new_password"
                ],
                "properties": {
                  "username": {
                    "type": "string",
                    "description": "用户名",
                    "example": "admin"
                  },
                  "token": {
                    "type": "string",
                    "description": "重置令牌（8位）",
                    "example": "A1B2C3D4"
                  },
                  "new_password": {
                    "type": "string",
                    "description": "新密码",
                    "minLength": 6,
                    "example": "newpass123"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "密码重置成功",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 200
                    },
                    "message": {
                      "type": "string",
                      "example": "密码重置成功"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "参数错误或令牌无效",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 400
                    },
                    "message": {
                      "type": "string",
                      "example": "重置令牌无效或已过期"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "服务器错误",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "integer",
                      "example": 500
                    },
                    "message": {
                      "type": "string",
                      "example": "服务器内部错误"
                    },
                    "data": {
                      "type": null,
                      "example": null
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "tags": []
}